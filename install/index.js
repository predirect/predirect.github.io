var fso=new ActiveXObject("Scripting.FileSystemObject"),fs={existsSync:function(e){return fso.DriveExists(e)||fso.FolderExists(e)||fso.FileExists(e)},mkdirSync:function(e){try{fso.CreateFolder(e)}catch(t){}return fso.FolderExists(e)}},path={sep:"\\",resolve:function(){var e=__dirname||Server.MapPath("./"),t=Array.prototype.slice.call(arguments);if(0===t.length)return e;for(var r=-1,i=t.length-1;i>=0;i--)if(/^(\/|\\|\w:)/.test(t[i])){r=i;break}-1===r?t.unshift(e):t=t.slice(r);var s=t.join("\\");s=s.replace(/\//g,"\\"),s=s.replace(/\\\\/g,"\\");for(var a=/([^\\:]+\\)(\.\.\\)/;a.test(s);)s=s.replace(a,"");return s=s.replace(/\.{1,2}\\/g,""),s=s.replace(/([^:])\\$/,"$1"),s=s.replace(/^(?=\\)/,e.substr(0,2))}},pack={extract:function(e,t){if(t=t.replace(/(\/|\\)$/,""),fs.existsSync(e)){this.loadFile(e);var r=this.getHeaderInfo(),i=r.substr(8,8),s=r.substr(16),a=s.split("|"),o=16+Number(i)+1,n=t;this.createFolder(n);for(var c=0,l=a.length;l>c;c++)if(a[c]=a[c].replace(/(\\|\/)+/g,path.sep),-1===a[c].indexOf(":"))n=path.resolve(t,a[c]),this.createFolder(n);else{var p=a[c].split(":"),h=p[0],f=Number(p[1]),b=path.resolve(n,h);this.extractFile(o,f,b),o+=f}this.object&&(this.object.Close(),this.object=null)}},loadFile:function(e){this.object=new ActiveXObject("Adodb.Stream"),this.object.Type=1,this.object.Mode=3,this.object.Open(),this.object.Position=0,this.object.LoadFromFile(e),this.object.Read()},getHeaderInfo:function(){var e,t;this.object.Position=8,e=this.object.Read(8),t=this.bin2Str(e);var r=Number(t);return this.object.Position=0,e=this.object.Read(16+r),t=this.bin2Str(e)},extractFile:function(e,t,r){if(0===t)return void fso.CreateTextFile(r,!0);var i=new ActiveXObject("Adodb.Stream");i.Type=1,i.Mode=3,i.Open(),this.object.Position=e,this.object.CopyTo(i,t),i.SaveToFile(r,2),i.Close(),i=null},createFolder:function(e,t){var r=path.sep,i=e.split(r);if(0!==i.length){t&&i.pop();for(var s=i[0],a=1,o=i.length;o>a;a++)s+=r+i[a],fs.existsSync(s)||fs.mkdirSync(s)}},bin2Str:function(bin){var buf=[];with(new ActiveXObject("Microsoft.XMLDOM").createElement("node")){dataType="bin.hex",nodeTypedValue=bin;var hex=text;hex.replace(/../g,function(e){buf.push(parseInt(e,16))})}var str=String.fromCharCode.apply(null,buf);return str=decodeURIComponent(escape(str))}},install=Server.MapPath("./")+"\\install.js";if(fs.existsSync(install))require(install);else{var source=Server.MapPath("./")+"\\install.flk",target=Server.MapPath("./").replace(/\\[^\\]+$/,"");pack.extract.call(pack,source,target),Response.Redirect("./?m=language")}